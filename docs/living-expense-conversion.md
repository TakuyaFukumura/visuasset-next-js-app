# 生活費換算機能 仕様書

## 概要

直近の資産残高が、設定した月次生活費の何年何ヶ月分に相当するかを計算・可視化する機能。
実利回りを考慮した資産推移のシミュレーションも行い、生活費の支出が続いた場合に資産がいつ尽きるかをグラフと表で確認できる。

---

## 画面構成

画面は上から順に「設定エリア」「折れ線グラフ」「結果テーブル」の3セクションで構成する。

```
┌─────────────────────────────────┐
│  設定エリア                        │
│  （生活費・実利回りの入力フォーム）      │
├─────────────────────────────────┤
│  折れ線グラフ                       │
│  （資産推移シミュレーション）           │
├─────────────────────────────────┤
│  結果テーブル                       │
│  （年次の残高一覧）                   │
└─────────────────────────────────┘
```

---

## 設定エリア

### 生活費の入力項目

生活費はジャンルごとに分けて入力できる。各項目は画面上で変更可能とし、デフォルト値は下記とする。

| ジャンル | デフォルト値 |
|--------|------------|
| 家賃    | 42,000 円   |
| 食費    | 30,000 円   |
| 娯楽費   | 30,000 円   |
| 雑費    | 30,000 円   |

- 月次合計（円）は各ジャンルの合計として自動計算して表示する
- 年次合計（円）は月次合計 × 12 として自動計算して表示する

### 実利回りの入力

- デフォルト値：0.0%
- 小数点以下1桁まで入力可（例：2.5%）
- 資産残高に対して年率で適用し、支出後の残高に複利計算を行う

---

## 計算ロジック

### 生活費換算（現在資産が何年何ヶ月分か）

1. 直近の総資産額（万円）を取得する
2. 月次生活費合計（円）を計算する
3. `総資産額（円） ÷ 月次生活費合計（円）` を計算し、商を月数とする
4. 月数を `年数 = Math.floor(月数 / 12)` と `残月 = 月数 % 12` に変換して表示する

```
総資産残高（円） = 直近の総資産額（万円） × 10,000
月次生活費合計（円） = 家賃 + 食費 + 娯楽費 + 雑費
換算月数 = Math.floor(総資産残高 ÷ 月次生活費合計)
換算年数 = Math.floor(換算月数 ÷ 12)
換算残月 = 換算月数 % 12
表示: 「XX年YYヶ月分」
```

### 資産推移シミュレーション（実利回り考慮）

毎月の処理を1ステップとして、以下の順序で計算する。

```
当月残高 = 前月残高 × (1 + 実利回り / 12) - 月次生活費合計
```

- 残高がゼロ以下になった時点でシミュレーションを終了する
- シミュレーション結果は年次（12ヶ月ごと）に集計してグラフと表に表示する

---

## 折れ線グラフ

- X軸：シミュレーション開始年からの経過年数（または西暦年）
- Y軸：資産残高（万円）
- データ：シミュレーション結果の年次残高
- 資産がゼロになった時点で折れ線を終端とする
- Recharts の `LineChart` コンポーネントを使用する

---

## 結果テーブル

各行に以下の情報を表示する。

| カラム名         | 内容                         |
|----------------|------------------------------|
| 経過年数         | シミュレーション開始からの年数（0年目は初期値） |
| 西暦             | 対応する西暦年                  |
| 資産残高（万円）   | その年末時点の資産残高            |
| 生活費何年何ヶ月分 | 残高 ÷ 月次生活費で換算した期間     |

---

## 画面イメージ（ワイヤーフレーム）

```
生活費換算シミュレーション
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【設定】
  家賃：    [  42,000 ] 円/月
  食費：    [  30,000 ] 円/月
  娯楽費：  [  30,000 ] 円/月
  雑費：    [  30,000 ] 円/月
  ──────────────────────
  月次合計：  132,000 円/月
  年次合計：1,584,000 円/年

  実利回り： [ 0.0 ] %/年

  現在の総資産：XXX万円
  → 生活費 XX年 YY ヶ月分

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【資産推移（シミュレーション）】

  [折れ線グラフ]
   残高
   (万円)
    |＼
    |  ＼
    |    ＼
    |      ＼___
    |          ＼
    +─────────────→ 年
      0   5   10   15

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【年次残高テーブル】

  | 経過年数 | 西暦   | 資産残高（万円） | 生活費換算     |
  |--------|-------|-------------|-------------|
  |  0年目  | 2024年 |    XXX万円   |  XX年YYヶ月分 |
  |  1年目  | 2025年 |    XXX万円   |  XX年YYヶ月分 |
  |  ...   |  ...  |     ...     |     ...     |
```

---

## 技術方針

- ページパス：`/living-expense`（新規ページとして追加）
- 設定値は `useState` で管理し、画面内でリアクティブに更新する
- サーバー側への保存は行わない（localStorage への保存は将来対応として検討）
- コンポーネント構成（案）：
  - `LivingExpenseSettings`：設定エリアの入力フォーム
  - `LivingExpenseChart`：折れ線グラフ（Recharts `LineChart` を利用）
  - `LivingExpenseTable`：年次残高テーブル

---

## 関連ドキュメント

- [機能追加案](./feature-proposals.md)
